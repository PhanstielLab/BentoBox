<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to BentoBox • BentoBox</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to BentoBox">
<meta property="og:description" content="BentoBox">
<meta property="og:image" content="https://phanstiellab.github.io/bentobox/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BentoBox</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/our_philosophy.html">Our Philosophy</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_to_bentobox.html">Introduction to BentoBox</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PhanstielLab/BentoBox">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_to_bentobox_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to BentoBox</h1>
                        <h4 class="author">Nicole Kramer, Eric S. Davis, Craig Wenger, Sarah Parker, Erika Deoudes, and Douglas H. Phanstiel</h4>
            
            <h4 class="date">2021-05-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PhanstielLab/BentoBox/blob/master/vignettes/introduction_to_bentobox.Rmd"><code>vignettes/introduction_to_bentobox.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_to_bentobox.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p><img src="../man/figures/logo.png" align="right" width="140px" style="padding-left:20px; background-color:white; border-color: transparent"></p>
<p><code>BentoBox</code> is a coordinate-based, genomic visualization package for R. Using <code>grid</code> graphics, <code>BentoBox</code> empowers users to programatically and flexibly generate multi-panel figures. Tailored for genomics, <code>BentoBox</code> allows users to visualize large, complex genomic datasets while providing exquisite control over the arrangement of plots.</p>
<p><code>BentoBox</code> functions can be grouped into the following categories:</p>
<ul>
<li>
<p><strong>Page layout functions:</strong></p>
<p>Functions for creating <code>BentoBox</code> page layouts, drawing, showing, and hiding guides, as well as placing plots on the page.</p>
</li>
<li>
<p><strong>Reading functions:</strong></p>
<p>Functions for quickly reading in large biological datasets.</p>
</li>
<li>
<p><strong>Plotting functions:</strong></p>
<p>Contains genomic plotting functions, functions for placing <code>ggplots</code> and <code>base</code> plots, as well as functions for drawing simple shapes.</p>
</li>
<li>
<p><strong>Annotation functions:</strong></p>
<p>Enables users to add annotations to their plots, such as legends, axes, and scales.</p>
</li>
<li>
<p><strong>Meta functions:</strong></p>
<p>Functions that display <code>BentoBox</code> properties or operate on other <code>BentoBox</code> functions, or constructors for <code>BentoBox</code> objects.</p>
</li>
</ul>
<p>This vignette provides a best-practices guide for utilizing <code>BentoBox</code>. It begins with a Quick Start section that outlines usage examples for reading in and plotting the most commonly used genomic data. Then the following sections explore how BentoBox works in more detail, highlighting helpful topics that showcase the capabilities of BentoBox. For detailed usage of each function, see the function-specific reference examples with <code>?function()</code> (e.g. <code>?bb_plotBedpe()</code>).</p>
</div>
<div id="quick-start" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h1>
<div id="reading-data" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-data" class="anchor"></a>Reading data</h2>
<p><code>BentoBox</code> handles a wide array of genomic data types in various formats and file types. Not only does it work with <code>data.frames</code>, <code>data.tables</code>, <code>tibbles</code>, and Bioconductor <code>GRanges</code> objects, but it can also read in common genomic file types like BED, BEDPE, bigWig, and .hic files. While files can be read directly into <code>BentoBox</code> plotting functions, <code>BentoBox</code> also provides functions for reading in these large genomic data sets to work with them within the R environment:</p>
<ul>
<li>
<code><a href="../reference/bb_readBigwig.html">bb_readBigwig()</a></code>: Read in entire bigWig files, or read in specific genomic regions or strands of bigWig data.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wholeFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_readBigwig.html">bb_readBigwig</a></span><span class="op">(</span><span class="st">"/path/to/bigWig"</span><span class="op">)</span>

<span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_readBigwig.html">bb_readBigwig</a></span><span class="op">(</span><span class="st">"/path/to/bigWig"</span>, chrom <span class="op">=</span> <span class="st">"chr1"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">2000000</span><span class="op">)</span>

<span class="va">regionPlus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_readBigwig.html">bb_readBigwig</a></span><span class="op">(</span><span class="st">"/path/to/bigWig"</span>, chrom <span class="op">=</span> <span class="st">"chr1"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">2000000</span>,
                            strand <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span></code></pre></div>
<ul>
<li>
<code><a href="../reference/bb_readHic.html">bb_readHic()</a></code>: Read in genomic regions of .hic files with various data resolutions and normalizations.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chrom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_readHic.html">bb_readHic</a></span><span class="op">(</span><span class="st">"/path/to/hic"</span>, chrom <span class="op">=</span> <span class="st">"chr1"</span>, resolution <span class="op">=</span> <span class="fl">250000</span>, res_scale <span class="op">=</span> <span class="st">"BP"</span>, norm <span class="op">=</span> <span class="st">"NONE"</span><span class="op">)</span>

<span class="va">chromRegion</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_readHic.html">bb_readHic</a></span><span class="op">(</span><span class="st">"/path/to/hic"</span>, chrom <span class="op">=</span> <span class="st">"chr1"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">2000000</span>, 
                          resolution <span class="op">=</span> <span class="fl">10000</span>, res_scale <span class="op">=</span> <span class="st">"BP"</span>, norm <span class="op">=</span> <span class="st">"KR"</span><span class="op">)</span>

<span class="va">twoChroms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_readHic.html">bb_readHic</a></span><span class="op">(</span><span class="st">"/path/to/hic"</span>, chrom <span class="op">=</span> <span class="st">"chr1"</span>, altchrom <span class="op">=</span> <span class="st">"chr2"</span>, 
                        resolution <span class="op">=</span> <span class="fl">250000</span>, res_scale <span class="op">=</span> <span class="st">"BP"</span><span class="op">)</span></code></pre></div>
<p>For other filetypes, we recommend reading in files with <code>data.table</code> or <code>rtracklayer</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="st">"/path/to/file"</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rtracklayer</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/export.html">import</a></span><span class="op">(</span>con <span class="op">=</span> <span class="st">"/path/to/file"</span>, format <span class="op">=</span> <span class="st">"fileFormat"</span><span class="op">)</span></code></pre></div>
</div>
<div id="quick-plotting" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-plotting" class="anchor"></a>Quick plotting</h2>
<p><code>BentoBox</code> plotting functions contain 4 types of arguments:</p>
<ol style="list-style-type: decimal">
<li><p>Data reading argument (<code>data</code>)</p></li>
<li><p>Genomic locus arguments (<code>chrom</code>, <code>chromstart</code>, <code>chromend</code>, <code>assembly</code>)</p></li>
<li><p>Placement arguments (<code>x</code>, <code>y</code>, <code>width</code>, <code>height</code>, <code>just</code>, <code>default.units</code>, …) that define where each plot resides on a <code>bb_page</code></p></li>
<li><p>Attribute arguments that affect the data being plotted or the style of the plot (<code>norm</code>, <code>fill</code>, <code>fontcolor</code>, …) that vary between functions</p></li>
</ol>
<p>The quickest way to plot data is to omit the placement arguments. This will generate a <code>BentoBox</code> plot that fills up the entire graphics window and cannot be annotated. <strong>These plots are only meant to be used for quick genomic data inspection and not as final <code>BentoBox</code> plots.</strong> The only arguments that are required are the data arguments and locus arguments. The examples below show how to quickly plot different types of genomic data with plot defaults and included data types. To use your own data, replace the <code>data</code> argument with either a path to the file or an R object as described above.</p>
<div id="hi-c-matrices" class="section level3">
<h3 class="hasAnchor">
<a href="#hi-c-matrices" class="anchor"></a>Hi-C matrices</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load example Hi-C data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>

<span class="co">## Quick plot Hi-C data</span>
<span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/hic_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div id="signal-tracks" class="section level3">
<h3 class="hasAnchor">
<a href="#signal-tracks" class="anchor"></a>Signal tracks</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load example signal data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>

<span class="co">## Quick plot signal data</span>
<span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/signal_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div id="gene-tracks" class="section level3">
<h3 class="hasAnchor">
<a href="#gene-tracks" class="anchor"></a>Gene tracks</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load hg19 genomic annotation packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>

<span class="co">## Quick plot genes</span>
<span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>assembly <span class="op">=</span> <span class="st">"hg19"</span>,
             chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/gene_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div id="gwas-manhattan-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#gwas-manhattan-plots" class="anchor"></a>GWAS Manhattan plots</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load hg19 genomic annotation packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>

<span class="co">## Load example GWAS data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_gwasData"</span><span class="op">)</span>

<span class="co">## Quick plot GWAS data </span>
<span class="fu"><a href="../reference/bb_plotManhattan.html">bb_plotManhattan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_gwasData</span>, fill <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"steel blue"</span>, <span class="st">"grey"</span><span class="op">)</span>,
                 ymax <span class="op">=</span> <span class="fl">1.1</span>, cex <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/gwas_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="plotting-and-annotating-on-the-bentobox-page" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-and-annotating-on-the-bentobox-page" class="anchor"></a>Plotting and annotating on the <code>BentoBox</code> page</h2>
<p>To build complex, multi-panel <code>BentoBox</code> figures with annotations, we must:</p>
<ol style="list-style-type: decimal">
<li>Create a <code>BentoBox</code> coordinate page with <code><a href="../reference/bb_pageCreate.html">bb_pageCreate()</a></code>.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/quickpage-1.png" width="384" style="display: block; margin: auto;"></p>
<ol start="2" style="list-style-type: decimal">
<li>Provide values for the placement arguments (<code>x</code>, <code>y</code>, <code>width</code>, <code>height</code>, <code>just</code>, <code>default.units</code>) in plotting functions and save the output of the plotting function.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">2.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/quickpageHic-1.png" width="384" style="display: block; margin: auto;"></p>
<ol start="3" style="list-style-type: decimal">
<li>Annotate <code>BentoBox</code> plot objects by passing them into the <code>plot</code> argument of annotation functions.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>,
                     x <span class="op">=</span> <span class="fl">2.85</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">1.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>,
                   x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">2.75</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">0.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/quickpageAnno-1.png" width="384" style="display: block; margin: auto;"></p>
<p>For more information about how to place plots and annotations on a <code>BentoBox</code> page, check out the section <code>Working with plot objects</code>.</p>
</div>
<div id="exporting-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#exporting-plots" class="anchor"></a>Exporting plots</h2>
<p>When a <code>BentoBox</code> plot is ready to be saved and exported, we can first remove all page guides that were made with <code><a href="../reference/bb_pageCreate.html">bb_pageCreate()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageGuideHide.html">bb_pageGuideHide</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/quickpageHide-1.png" width="384" style="display: block; margin: auto;"></p>
<p>We can then either use the <strong>Export</strong> toggle in the RStudio plot panel, or save the plot within our R code as follows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.25</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">2.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>,
                     x <span class="op">=</span> <span class="fl">2.85</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">1.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>,
                   x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">2.75</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">0.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_pageGuideHide.html">bb_pageGuideHide</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="the-bentobox-page" class="section level1">
<h1 class="hasAnchor">
<a href="#the-bentobox-page" class="anchor"></a>The <code>BentoBox</code> page</h1>
<p><code>BentoBox</code> uses a coordinate-based plotting system to define the size and location of plots. This system makes the plotting process intuitive and absolute, meaning that plots cannot be squished and stretched based on their <em>relative</em> sizes. This also allows for precise control of the size of each visualization and the location of all plots, annotations, and text.</p>
<p>All <code>BentoBox</code> page functions begin with the <code>bb_page</code> prefix.</p>
<p>Users can create a page in their preferred size and unit of measurement using <code><a href="../reference/bb_pageCreate.html">bb_pageCreate()</a></code>. Within this function the user can also set gridlines in the vertical and horizontal directions with <code>xgrid</code> and <code>ygrid</code>, respectively. By default these values are set to 0.5 of the unit. In the following example we demonstrate creating a standard 8.5 x 11 inch page:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">8.5</span>, height <span class="op">=</span> <span class="fl">11</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo01-1.png" width="1056" style="display: block; margin: auto;"></p>
<p>Or we could create a smaller sized page in a different set of units with different gridlines:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">8</span>, xgrid <span class="op">=</span> <span class="fl">1</span>, ygrid <span class="op">=</span> <span class="fl">1</span>, default.units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo02-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We could turn off gridlines entirely by setting <code>xgrid</code> and <code>ygrid</code> to 0:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo03-1.png" width="480" style="display: block; margin: auto;"></p>
<p>If we want more specific gridlines on our page, we can use the <code><a href="../reference/bb_pageGuideHorizontal.html">bb_pageGuideHorizontal()</a></code> and <code><a href="../reference/bb_pageGuideVertical.html">bb_pageGuideVertical()</a></code> functions:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="co">## Add a horizontal guide at y = 2.25 inches</span>
<span class="fu"><a href="../reference/bb_pageGuideHorizontal.html">bb_pageGuideHorizontal</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">2.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="co">## Add a vertical guide at x = 0.75 inches</span>
<span class="fu"><a href="../reference/bb_pageGuideVertical.html">bb_pageGuideVertical</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.75</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo04-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can also remove all guidelines from the plot once we are finished using guides by using the <code><a href="../reference/bb_pageGuideHide.html">bb_pageGuideHide()</a></code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo05-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Remove guides</span>
<span class="fu"><a href="../reference/bb_pageGuideHide.html">bb_pageGuideHide</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo05-2.png" width="480" style="display: block; margin: auto;"></p>
<div id="coordinate-systems-and-units" class="section level2">
<h2 class="hasAnchor">
<a href="#coordinate-systems-and-units" class="anchor"></a>Coordinate systems and units</h2>
<p><code>BentoBox</code> is compatible with numerous coordinate systems, which are flexible enough to be used in combination. Brief descriptions of the most commonly used <code>BentoBox</code> coordinate systems are as follows:</p>
<table class="table">
<colgroup>
<col width="59%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th align="right">Coordinate System</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><strong>“npc”</strong></td>
<td align="left">Normalized Parent Coordinates. Treats the bottom-left corner of the plotting region as the location (0,0) and the top-right corner as (1,1).</td>
</tr>
<tr class="even">
<td align="right"><strong>“snpc”</strong></td>
<td align="left">Squared Normalized Parent Coordiantes. Placements and sizes are expressed as a proportion of the smaller of the width and height of the plotting region.</td>
</tr>
<tr class="odd">
<td align="right"><strong>“native”</strong></td>
<td align="left">Placements and sizes are relative to the x- and y-scales of the plotting region.</td>
</tr>
<tr class="even">
<td align="right"><strong>“inches”</strong></td>
<td align="left">Placements and sizes are in terms of physical inches.</td>
</tr>
<tr class="odd">
<td align="right"><strong>“cm”</strong></td>
<td align="left">Placements and sizes are in terms of physical centimeters.</td>
</tr>
<tr class="even">
<td align="right"><strong>“mm”</strong></td>
<td align="left">Placements and sizes are in terms of physical millimeters.</td>
</tr>
<tr class="odd">
<td align="right"><strong>“points”</strong></td>
<td align="left">Placements and sizes are in terms of physical points. There are 72.27 points per inch.</td>
</tr>
</tbody>
</table>
<p>We can set the <code>bb_page</code> in one coordinate system, but then place and arrange our plots using other coordinate systems. For example, we can set our page as 3 x 3 <strong>inches</strong>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/coord_01-1.png" width="480" style="display: block; margin: auto;"></p>
<p>But we can then switch to <strong>npc</strong> coordinates to plot something in the center of the page at (0.5, 0.5) npc. The <code><a href="https://rdrr.io/r/grid/unit.html">unit()</a></code> function allows us to easily specify <code>x</code>, <code>y</code>, <code>width</code>, and <code>height</code> in combinations of different units in one plotting function call.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_plotRect.html">bb_plotRect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"npc"</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"npc"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">1</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/coord_02-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The <strong>native</strong> coordinate system is particularly useful for annotation functions that can plot relative to the genomic scales of a plot. For example, we can use <code><a href="../reference/bb_annoText.html">bb_annoText()</a></code> to annotate some text at a specific genomic location in a plot:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">1.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>
<span class="va">signalPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">4</span>, height <span class="op">=</span> <span class="fl">0.75</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">signalPlot</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">1.01</span><span class="op">)</span>

<span class="co">## Annotate text at average x-coordinate of data peak</span>
<span class="va">peakScore</span> <span class="op">&lt;-</span> <span class="va">bb_imrH3K27acData</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">bb_imrH3K27acData</span><span class="op">$</span><span class="va">score</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">bb_imrH3K27acData</span><span class="op">$</span><span class="va">score</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">peakPos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">peakScore</span><span class="op">$</span><span class="va">start</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">peakScore</span><span class="op">$</span><span class="va">end</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_annoText.html">bb_annoText</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">signalPlot</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">peakPos</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, fontsize <span class="op">=</span> <span class="fl">8</span>,
            x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="va">peakPos</span>, <span class="st">"native"</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span>,
            just <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/coord_03-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="working-with-plot-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-plot-objects" class="anchor"></a>Working with plot objects</h2>
<p>In <code>BentoBox</code> all plot objects are boxes, with user-defined positions and sizes. All plot objects can be placed on a <code>bb_page</code> using the placement arguments (e.g. <code>x</code>, <code>y</code>, <code>width</code>, <code>height</code>, <code>just</code>, <code>default.units</code>, …). The <code>bb_page</code> sets the origin of the plot at the top left corner of the page. By default, the <code>x</code> and <code>y</code> arguments place the top-left corner of a plot in the specified position on the <code>bb_page</code> while the <code>width</code> and <code>height</code> arguments define the size of the plot.</p>
<p>For example, if users want the top-left corner of their plot to be 0.5 inches down from the top of the page and 0.5 inches from the left…</p>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example01-1.png" width="480" style="display: block; margin: auto;"></p>
<p>and the plot to be 2 inches wide and 1 inch tall…</p>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example02-1.png" width="480" style="display: block; margin: auto;"></p>
<p><code>BentoBox</code> can make the plot with these exact dimensions:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot rectangle</span>
<span class="fu"><a href="../reference/bb_plotRect.html">bb_plotRect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>,
            just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example03-1.png" width="480" style="display: block; margin: auto;"></p>
<p><code>BentoBox</code> also provides the helper function <code><a href="../reference/bb_pagePlotPlace.html">bb_pagePlotPlace()</a></code> for placing plot objects that have been previously defined:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>

<span class="co">## Create page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Define signal plot</span>
<span class="va">signalPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co">## Place plot on bb_page</span>
<span class="fu"><a href="../reference/bb_pagePlotPlace.html">bb_pagePlotPlace</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">signalPlot</span>,
                 x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>, 
                 just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example04-1.png" width="480" style="display: block; margin: auto;"></p>
<p>and <code><a href="../reference/bb_pagePlotRemove.html">bb_pagePlotRemove()</a></code> for removing plots from a page:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>

<span class="co">## Create page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot and place signal plot</span>
<span class="va">signalPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>,
                            just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example05-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Remove signal plot</span>
<span class="fu"><a href="../reference/bb_pagePlotRemove.html">bb_pagePlotRemove</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">signalPlot</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example05-2.png" width="480" style="display: block; margin: auto;"></p>
<p>These functions give the users additional flexibility in how they create their R scripts and <code>BentoBox</code> layouts.</p>
</div>
<div id="using-the-just-parameter" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-just-parameter" class="anchor"></a>Using the <code>just</code> parameter</h2>
<p>While the <code>x</code>, <code>y</code>, <code>width</code>, and <code>height</code> parameters are relative to the top-left corner of the plot by default, the <code>just</code> parameter provides additional flexibility by allowing users to change the placement reference point. The <code>just</code> parameter accepts a character or numeric vector of length 2 describing the horizontal and vertical justification (or reference point), respectively.</p>
<p>The just parameter can be set using character strings <code>"left"</code>, <code>"right"</code>, <code>"center"</code>, <code>"bottom"</code> and <code>"top"</code>:</p>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example06-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Or it can be set using numeric values where 0 means left/bottom, 1 means right/top, and 0.5 means center:</p>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example07-1.png" width="576" style="display: block; margin: auto;"></p>
<p>This is particularly useful when an object needs to be aligned in reference to another plot object or page marker. For example, in the Hi-C plot below we might want to align the top-right corner of the heatmap legend to the 3-inch mark. There is no need to calculate the top-left position (i.e. <code>3 inches - (legend width)</code>) to determine where to place the heatmap legend. Instead we can change the <code>just</code> parameter to <code>just=c('right', 'top')</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load example Hi-C data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>

<span class="co">## Create a BentoBox page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot Hi-C data with placing information</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">2.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Add color scale annotation with just = c("right", "top")</span>
<span class="fu"><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>,
                     x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">1.25</span>,
                     just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example08-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="plotting-multi-omic-data" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-multi-omic-data" class="anchor"></a>Plotting multi-omic data</h1>
<p><code>BentoBox</code> makes it easy to create reproducible, publication-quality figures from multi-omic data. Since each plot can be placed in <em>exactly</em> the desired location, users can stack multiple types of genomic data so that their axes and data are correctly aligned. In this section we will show some examples of plotting multi-omic data and how the <code>bb_params</code> object and “below” y-coordinate can facilitate this process.</p>
<p>In the following example, we plot the same genomic region (i.e. <code>chr21:28000000-30300000</code>) represented in Hi-C data, loop annotations, signal track data, GWAS data, all along a common gene track and genome label axis:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load example data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedpeData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_gwasData"</span><span class="op">)</span>

<span class="co">## Create a BentoBox page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co">## Plot Hi-C data in region</span>
<span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                 x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">2</span>,
                 just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot loop annotations</span>
<span class="fu"><a href="../reference/bb_plotBedpeArches.html">bb_plotBedpeArches</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_bedpeData</span>,
                   chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                   x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">2.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">0.25</span>, 
                   just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
                   fill <span class="op">=</span> <span class="st">"black"</span>, linecolor <span class="op">=</span> <span class="st">"black"</span>, flip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## Plot signal track data</span>
<span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
              chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
              x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">2.75</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">0.5</span>, 
              just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot GWAS data </span>
<span class="fu"><a href="../reference/bb_plotManhattan.html">bb_plotManhattan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_gwasData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                 ymax <span class="op">=</span> <span class="fl">1.1</span>, cex <span class="op">=</span> <span class="fl">0.20</span>,
                 x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">3.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">0.5</span>,
                 just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot gene track</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
             x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">4</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">0.5</span>,
             just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot genome label</span>
<span class="fu"><a href="../reference/bb_plotGenomeLabel.html">bb_plotGenomeLabel</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                   x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">4.5</span>, length <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="st">"Mb"</span>,
                   just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/plotting_example01-1.png" width="480" style="display: block; margin: auto;"></p>
<div id="using-the-bb_params-object" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-bb_params-object" class="anchor"></a>Using the <code>bb_params</code> object</h2>
<p>The <code><a href="../reference/bb_params.html">bb_params()</a></code> function creates a <code>bb_params</code> object that can contain any argument from <code>BentoBox</code> functions.</p>
<p>We can recreate and simplify the multi-omic plot above by saving the genomic region, left-based x-coordinate, and width into a <code>bb_params</code> object:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_params.html">bb_params</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                    x <span class="op">=</span> <span class="fl">0.5</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                    width <span class="op">=</span> <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">2</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p>Since these values are the same for each of the functions we are using to build our multi-omic figure, we can now pass the <code>bb_params</code> object into our functions so we don’t need to write the same parameters over and over again:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load example data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedpeData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_gwasData"</span><span class="op">)</span>

<span class="co">## Create a BentoBox page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co">## Plot Hi-C data in region</span>
<span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                 params <span class="op">=</span> <span class="va">params</span>,
                 y <span class="op">=</span> <span class="fl">0.5</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co">## Plot loop annotations</span>
<span class="fu"><a href="../reference/bb_plotBedpeArches.html">bb_plotBedpeArches</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_bedpeData</span>,
                   params <span class="op">=</span> <span class="va">params</span>,
                   y <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">0.25</span>, 
                   fill <span class="op">=</span> <span class="st">"black"</span>, linecolor <span class="op">=</span> <span class="st">"black"</span>, flip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## Plot signal track data</span>
<span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
              params <span class="op">=</span> <span class="va">params</span>,
              y <span class="op">=</span> <span class="fl">2.75</span>, height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="co">## Plot GWAS data </span>
<span class="fu"><a href="../reference/bb_plotManhattan.html">bb_plotManhattan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_gwasData</span>,
                 params <span class="op">=</span> <span class="va">params</span>,
                 ymax <span class="op">=</span> <span class="fl">1.1</span>, cex <span class="op">=</span> <span class="fl">0.20</span>,
                 y <span class="op">=</span> <span class="fl">3.5</span>, height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="co">## Plot gene track</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">params</span>,
             y <span class="op">=</span> <span class="fl">4</span>, height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="co">## Plot genome label</span>
<span class="fu"><a href="../reference/bb_plotGenomeLabel.html">bb_plotGenomeLabel</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">params</span>,
                   y <span class="op">=</span> <span class="fl">4.5</span>, scale <span class="op">=</span> <span class="st">"Mb"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/plotting_example02-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The <code>bb_params</code> object also simplifies the code for making complex multi-omic figures when we want to change the genomic region of our plots. If we want to change the region for the figure above, we can simply put it into the <code>bb_params</code> object and re-run the code to generate the figure:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_params.html">bb_params</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">29000000</span>, chromend <span class="op">=</span> <span class="fl">30000000</span>,
                    x <span class="op">=</span> <span class="fl">0.5</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                    width <span class="op">=</span> <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">2</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/plotting_example03-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Alternatively, if we want to plot around a particular gene rather than a genomic region we can use <code><a href="../reference/bb_params.html">bb_params()</a></code> to specify <code>gene</code> and <code>geneBuffer</code>. If <code>geneBuffer</code> is not included, the default buffer adds <code>(gene length) / 2</code> base pairs to the ends of the gene coordinates.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_params.html">bb_params</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="st">"LINC00113"</span>, geneBuffer <span class="op">=</span> <span class="fl">100000</span>, assembly <span class="op">=</span> <span class="st">"hg19"</span>,
                    x <span class="op">=</span> <span class="fl">0.5</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                    width <span class="op">=</span> <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">2</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/plotting_example04-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="the-below-y-coordinate" class="section level2">
<h2 class="hasAnchor">
<a href="#the-below-y-coordinate" class="anchor"></a>The “below” y-coordinate</h2>
<p>Since multi-omic plots often involve vertical stacking, the placement of multi-omic plots can be facilitated with the “below” y-coordinate. Rather than providing a <code>numeric</code> value or <code>unit</code> object to the <code>y</code> parameter in plotting functions, we can place a plot below the previously drawn <code>BentoBox</code> plot with a <code>character</code> value consisting of the distance below the last plot, in page units, and “b”. For example, on a page made in inches, <code>y = "0.1b"</code> will place a plot 0.1 inches below the last drawn plot.</p>
<p>We can further simplify the placement code of our multi-omic figure above by using the “below” y-coordinate to easily stack our plots:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load example data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedpeData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_gwasData"</span><span class="op">)</span>

<span class="co">## bb_params</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_params.html">bb_params</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                    x <span class="op">=</span> <span class="fl">0.5</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                    width <span class="op">=</span> <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">2</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Create a BentoBox page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co">## Plot Hi-C data in region</span>
<span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                 params <span class="op">=</span> <span class="va">params</span>,
                 y <span class="op">=</span> <span class="fl">0.5</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co">## Plot loop annotations</span>
<span class="fu"><a href="../reference/bb_plotBedpeArches.html">bb_plotBedpeArches</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_bedpeData</span>,
                   params <span class="op">=</span> <span class="va">params</span>,
                   y <span class="op">=</span> <span class="st">"0b"</span>, 
                   height <span class="op">=</span> <span class="fl">0.25</span>, 
                   fill <span class="op">=</span> <span class="st">"black"</span>, linecolor <span class="op">=</span> <span class="st">"black"</span>, flip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## Plot signal track data</span>
<span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
              params <span class="op">=</span> <span class="va">params</span>,
              y <span class="op">=</span> <span class="st">"0b"</span>, 
              height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="co">## Plot GWAS data </span>
<span class="fu"><a href="../reference/bb_plotManhattan.html">bb_plotManhattan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_gwasData</span>,
                 params <span class="op">=</span> <span class="va">params</span>,
                 ymax <span class="op">=</span> <span class="fl">1.1</span>, cex <span class="op">=</span> <span class="fl">0.20</span>,
                 y <span class="op">=</span> <span class="st">"0.25b"</span>, 
                 height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="co">## Plot gene track</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">params</span>,
             y <span class="op">=</span> <span class="st">"0b"</span>, 
             height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="co">## Plot genome label</span>
<span class="fu"><a href="../reference/bb_plotGenomeLabel.html">bb_plotGenomeLabel</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">params</span>,
                   y <span class="op">=</span> <span class="st">"0b"</span>, 
                   scale <span class="op">=</span> <span class="st">"Mb"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/below_y-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="additional-plot-types-and-elements" class="section level1">
<h1 class="hasAnchor">
<a href="#additional-plot-types-and-elements" class="anchor"></a>Additional plot types and elements</h1>
<p>Beyond providing functions for plotting and arranging various genomic datasets, <code>BentoBox</code> also gives users the functionality to plot other elements within a <code>BentoBox</code> page layout:</p>
<div id="ideograms" class="section level2">
<h2 class="hasAnchor">
<a href="#ideograms" class="anchor"></a>Ideograms</h2>
<p>In addition to a genomic axis label, it can also be useful to include an ideogram representation of a chromosome to give a broader context of the location of genomic data. UCSC Giemsa stain cytoband information for various genomic assemblies is included with <code>BentoBox</code> and must be loaded before plotting an ideogram (i.e.<code><a href="https://rdrr.io/r/utils/data.html">data("cytoBand.Hsapiens.UCSC.hg19")</a></code>).</p>
<p>Ideograms can be plotted both vertically and horizontally:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load cytoband data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"cytoBand.Hsapiens.UCSC.hg19"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomeInfoDb">GenomeInfoDb</a></span><span class="op">)</span>

<span class="co">## Get sizes of chromosomes to scale their sizes</span>
<span class="va">tx_db</span> <span class="op">&lt;-</span> <span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span>
<span class="va">chromSizes</span> <span class="op">&lt;-</span> <span class="fu">GenomeInfoDb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html">seqlengths</a></span><span class="op">(</span><span class="va">tx_db</span><span class="op">)</span>
<span class="va">maxChromSize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">chromSizes</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">4.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">xCoord</span> <span class="op">&lt;-</span> <span class="fl">0.15</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">chr</span> <span class="kw">in</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">22</span><span class="op">)</span><span class="op">)</span>, <span class="st">"chrX"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>

  <span class="va">height</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">4</span><span class="op">*</span><span class="va">chromSizes</span><span class="op">[[</span><span class="va">chr</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">maxChromSize</span>
  <span class="fu"><a href="../reference/bb_plotIdeogram.html">bb_plotIdeogram</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="va">chr</span>, assembly <span class="op">=</span> <span class="st">"hg19"</span>,
                  orientation <span class="op">=</span> <span class="st">"v"</span>,
                  x <span class="op">=</span> <span class="va">xCoord</span>, y <span class="op">=</span> <span class="fl">4</span>, 
                  width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="va">height</span>,
                  just <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
  <span class="fu"><a href="../reference/bb_plotText.html">bb_plotText</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="st">""</span>, <span class="va">chr</span><span class="op">)</span>, 
              x <span class="op">=</span> <span class="va">xCoord</span>, y <span class="op">=</span> <span class="fl">4.1</span>, fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
  <span class="va">xCoord</span> <span class="op">&lt;-</span> <span class="va">xCoord</span> <span class="op">+</span> <span class="fl">0.35</span>
  
<span class="op">}</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/ideogram_01-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">6.25</span>, height <span class="op">=</span> <span class="fl">0.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_plotIdeogram.html">bb_plotIdeogram</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr1"</span>, assembly <span class="op">=</span> <span class="st">"hg19"</span>,
                orientation <span class="op">=</span> <span class="st">"h"</span>,
                x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="st">"npc"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">5.75</span>, height <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/ideogram_02-1.png" width="792" style="display: block; margin: auto;"></p>
<p>The cytobands can also be hidden if a more minimal ideogram is preferred:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_plotIdeogram.html">bb_plotIdeogram</a></span><span class="op">(</span>showBands <span class="op">=</span> <span class="cn">FALSE</span>,
                chrom <span class="op">=</span> <span class="st">"chr1"</span>, assembly <span class="op">=</span> <span class="st">"hg19"</span>,
                orientation <span class="op">=</span> <span class="st">"h"</span>,
                x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="st">"npc"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">5.75</span>, height <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/ideogram_03-1.png" width="792" style="display: block; margin: auto;"></p>
<p>To highlight a specific genomic region on an ideogram, see the section <code>Genomic region highlights and zooms</code>.</p>
</div>
<div id="incorporating-ggplots" class="section level2">
<h2 class="hasAnchor">
<a href="#incorporating-ggplots" class="anchor"></a>Incorporating <code>ggplots</code>
</h2>
<p>In addition to its numerous genomic functions, <code>BentoBox</code> can size and place <code>ggplots</code> within a <code>BentoBox</code> layout. Rather than arranging <code>ggplots</code> in a relative manner, <code>BentoBox</code> can make and place <code>ggplots</code> in absolute sizes and locations. This makes it simple and intuitive to make complex <code>ggplot</code> arrangements beyond a basic grid-style layout.</p>
<p>For example, let’s say we wanted to make a complex multi-panel ggplot about COVID-19 data consisting of the following plots:</p>
<ol style="list-style-type: decimal">
<li>A United States map</li>
</ol>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_CasesUSA"</span><span class="op">)</span>

<span class="va">US_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bb_CasesUSA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cases_100K</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"YlGnBu"</span>, direction <span class="op">=</span> <span class="fl">1</span>,
                       labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_number</a></span><span class="op">(</span>suffix <span class="op">=</span> <span class="st">""</span>, scale <span class="op">=</span> <span class="fl">1e-3</span>, accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"left"</span>,
        legend.justification <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span>,
        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
        legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="st">"cm"</span><span class="op">)</span>,
        legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="st">"cm"</span><span class="op">)</span>,
        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,
        plot.title.position <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Thousands of COVID-19 Cases per 100,000 People"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">US_map</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/ggplot_01-1.png" width="288" style="display: block; margin: auto;"></p>
<ol start="2" style="list-style-type: decimal">
<li>Timeline line plots:</li>
</ol>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_CasesNYFL"</span><span class="op">)</span>

<span class="co"># Format y-labels</span>
<span class="va">ylabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2000000</span>, by <span class="op">=</span> <span class="fl">500000</span><span class="op">)</span><span class="op">/</span><span class="fl">1e6</span>
<span class="va">ylabels</span><span class="op">[</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ylabels</span><span class="op">[</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">ylabels</span><span class="op">[</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ylabels</span><span class="op">[</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">ylabels</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ylabels</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="st">"M cases"</span><span class="op">)</span>

<span class="va">cases_NYline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bb_CasesNYFL</span><span class="op">[</span><span class="va">bb_CasesNYFL</span><span class="op">$</span><span class="va">state</span> <span class="op">==</span> <span class="st">"new york"</span>,<span class="op">]</span>,
                       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">caseIncrease</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_date.html">date_format</a></span><span class="op">(</span><span class="st">"%b '%y"</span><span class="op">)</span>,
               breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"2020-05-01"</span>, <span class="st">"2020-09-01"</span>, <span class="st">"2021-01-01"</span><span class="op">)</span><span class="op">)</span>,
               limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"2020-01-29"</span>, <span class="st">"2021-03-07"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">ylabels</span>, position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2000000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,
        plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,
        axis.line.x.bottom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,
        axis.line.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,
        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, vjust <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,
        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.length.x.bottom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.15</span>, <span class="st">"cm"</span><span class="op">)</span>,
        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
        plot.title.position <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cases_NYline</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/ggplot_02-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cases_FLline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bb_CasesNYFL</span><span class="op">[</span><span class="va">bb_CasesNYFL</span><span class="op">$</span><span class="va">state</span> <span class="op">==</span> <span class="st">"florida"</span>,<span class="op">]</span>,
                       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">caseIncrease</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_date.html">date_format</a></span><span class="op">(</span><span class="st">"%b '%y"</span><span class="op">)</span>,
               breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"2020-05-01"</span>, <span class="st">"2020-09-01"</span>, <span class="st">"2021-01-01"</span><span class="op">)</span><span class="op">)</span>,
               limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"2020-01-29"</span>, <span class="st">"2021-03-07"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">ylabels</span>, position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2000000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,
        plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,
        axis.line.x.bottom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,
        axis.line.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,
        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, vjust <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,
        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.length.x.bottom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.15</span>, <span class="st">"cm"</span><span class="op">)</span>,
        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
        plot.title.position <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cases_FLline</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/ggplot_03-1.png" width="288" style="display: block; margin: auto;"></p>
<ol start="3" style="list-style-type: decimal">
<li>Pie charts:</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_VaccinesNYFL"</span><span class="op">)</span>

<span class="va">vaccines_NYpie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bb_VaccinesNYFL</span><span class="op">[</span><span class="va">bb_VaccinesNYFL</span><span class="op">$</span><span class="va">state</span> <span class="op">==</span> <span class="st">"new york"</span>,<span class="op">]</span>,
                         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">vax_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"#3a6dab"</span>, <span class="st">"light grey"</span>,<span class="st">"#85a9d5"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">"y"</span>, start <span class="op">=</span> <span class="fl">2.125</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1.1</span>, label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">percent</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"black"</span><span class="op">)</span>,
            size <span class="op">=</span> <span class="fl">1.75</span>,
            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_stack</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>,
           x <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="fl">1.95</span>, <span class="fl">2.4</span><span class="op">)</span>,
           y <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">8.5e6</span>, <span class="fl">9e5</span>, <span class="fl">1.6e7</span><span class="op">)</span>,
           label <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"not"</span>, <span class="st">"partially"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"fully"</span>, <span class="st">"vaccinated"</span>, sep <span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">)</span>,
           size <span class="op">=</span> <span class="fl">2.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">6.5</span>, size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"New York"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">vaccines_NYpie</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/ggplot_04-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">vaccines_FLpie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bb_VaccinesNYFL</span><span class="op">[</span><span class="va">bb_VaccinesNYFL</span><span class="op">$</span><span class="va">state</span> <span class="op">==</span> <span class="st">"florida"</span>,<span class="op">]</span>,
                         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">vax_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"#3a6dab"</span>, <span class="st">"light grey"</span>,<span class="st">"#85a9d5"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">"y"</span>, start <span class="op">=</span> <span class="va">pi</span><span class="op">/</span><span class="fl">1.78</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1.1</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">percent</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"black"</span><span class="op">)</span>,
            size <span class="op">=</span> <span class="fl">1.75</span>,
            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_stack</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>,
           x <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="fl">2.05</span>, <span class="fl">2.4</span><span class="op">)</span>,
           y <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">1.05e7</span>, <span class="fl">9.25e5</span>, <span class="fl">1.865e7</span><span class="op">)</span>,
           label <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"not"</span>, <span class="st">"partially"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"fully"</span>, <span class="st">"vaccinated"</span>, sep <span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">)</span>,
           size <span class="op">=</span> <span class="fl">2.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">7</span>, size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Florida"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">vaccines_FLpie</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/ggplot_05-1.png" width="288" style="display: block; margin: auto;"></p>
<p>We can now easily overlap and size all these <code>ggplots</code> by passing our saved plot objects into <code><a href="../reference/bb_plotGG.html">bb_plotGG()</a></code>:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span>, height <span class="op">=</span> <span class="fl">3.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_plotGG.html">bb_plotGG</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">US_map</span>,
          x <span class="op">=</span> <span class="fl">0.1</span>,y <span class="op">=</span> <span class="fl">0</span>,
          width <span class="op">=</span> <span class="fl">6.5</span>, height <span class="op">=</span> <span class="fl">3.5</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotGG.html">bb_plotGG</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">cases_NYline</span>,
          x <span class="op">=</span> <span class="fl">6.3</span>, y <span class="op">=</span> <span class="fl">1.8</span>,
          width <span class="op">=</span> <span class="fl">2.9</span>, height <span class="op">=</span> <span class="fl">1.7</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotGG.html">bb_plotGG</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">cases_FLline</span>,
          x <span class="op">=</span> <span class="fl">6.3</span>, y <span class="op">=</span> <span class="fl">3.5</span>,
          width <span class="op">=</span> <span class="fl">2.9</span>, height <span class="op">=</span> <span class="fl">1.7</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/gg_plot05-1.png" width="1104" style="display: block; margin: auto;"></p>
<p>In particular, <code>BentoBox</code> makes it easy to resize and place our pie charts in a layout that overlaps our line plots without it affecting the sizing of the other plots on the page:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_plotGG.html">bb_plotGG</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">vaccines_NYpie</span>,
          x <span class="op">=</span> <span class="fl">6.2</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>,
          width <span class="op">=</span> <span class="fl">1.8</span>, height <span class="op">=</span> <span class="fl">1.8</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotGG.html">bb_plotGG</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">vaccines_FLpie</span>,
          x <span class="op">=</span> <span class="fl">6.2</span>, y <span class="op">=</span> <span class="fl">1.5</span>,
          width <span class="op">=</span> <span class="fl">1.8</span>, height <span class="op">=</span> <span class="fl">1.8</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/gg_plot06-1.png" width="1104" style="display: block; margin: auto;"></p>
<p>We are then left with a complex, elegant arrangement of <code>ggplots</code> as if we had arranged them together with graphic design software:</p>
<p><img src="introduction_to_bentobox_files/figure-html/gg_plot07-1.png" width="1104" style="display: block; margin: auto;"></p>
</div>
<div id="basic-shapes" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-shapes" class="anchor"></a>Basic shapes</h2>
<p>It is also possible to plot basic shapes and images to further enhance a <code>BentoBox</code> layout. These functions include <code><a href="../reference/bb_plotCircle.html">bb_plotCircle()</a></code>, <code><a href="../reference/bb_plotPolygon.html">bb_plotPolygon()</a></code>, <code><a href="../reference/bb_plotRaster.html">bb_plotRaster()</a></code>, <code><a href="../reference/bb_plotRect.html">bb_plotRect()</a></code>, <code><a href="../reference/bb_plotSegments.html">bb_plotSegments()</a></code>, and <code><a href="../reference/bb_plotText.html">bb_plotText()</a></code>.</p>
<p>For example, perhaps we want to create a presentation slide detailing an experimental workflow. Not only can we add <code>BentoBox</code> plots based on genomic data:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">4.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
              chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
              x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">2</span>, width <span class="op">=</span> <span class="fl">2.25</span>, height <span class="op">=</span> <span class="fl">1</span>, 
              just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                 x <span class="op">=</span> <span class="fl">3.25</span>, y <span class="op">=</span> <span class="fl">1.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">2</span>,
                 just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/shapes_01-1.png" width="960" style="display: block; margin: auto;"></p>
<p>But we can also add some text labels for the title of our slide and the the steps of our workflow:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_plotText.html">bb_plotText</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"EXPERIMENTAL WORKFLOW"</span>, fontsize <span class="op">=</span> <span class="fl">24</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>,
            x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.5</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotText.html">bb_plotText</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"H3K27ac"</span>, fontsize <span class="op">=</span> <span class="fl">16</span>,
            x <span class="op">=</span> <span class="fl">1.375</span>, y <span class="op">=</span> <span class="fl">4</span>, just <span class="op">=</span> <span class="st">"center"</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotText.html">bb_plotText</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Hi-C"</span>, fontsize <span class="op">=</span> <span class="fl">16</span>,
            x <span class="op">=</span> <span class="fl">4.25</span>, y <span class="op">=</span> <span class="fl">4</span>, just <span class="op">=</span> <span class="st">"center"</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotText.html">bb_plotText</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Analysis"</span>, fontsize <span class="op">=</span> <span class="fl">16</span>,
            x <span class="op">=</span> <span class="fl">6.875</span>, y <span class="op">=</span> <span class="fl">4</span>, just <span class="op">=</span> <span class="st">"center"</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/shapes_02-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Add an image:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rforge.net/png/">png</a></span><span class="op">)</span>
<span class="va">rlogo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html">readPNG</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"images"</span>, <span class="st">"Rlogo.png"</span>, package <span class="op">=</span> <span class="st">"BentoBox"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotRaster.html">bb_plotRaster</a></span><span class="op">(</span>image <span class="op">=</span> <span class="va">rlogo</span>,
               x <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">2.5</span>, width <span class="op">=</span> <span class="fl">1.75</span>, height <span class="op">=</span> <span class="fl">1.55</span>,
               just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/shapes_03-1.png" width="960" style="display: block; margin: auto;"></p>
<p>And add line segments with arrows to our workflow:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_plotSegments.html">bb_plotSegments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">2.7</span>, y0 <span class="op">=</span> <span class="fl">2.5</span>, x1 <span class="op">=</span> <span class="fl">3.1</span>, y1 <span class="op">=</span> <span class="fl">2.5</span>, 
                linecolor <span class="op">=</span> <span class="st">"grey"</span>, fill <span class="op">=</span> <span class="st">"grey"</span>,
                arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>,
                              length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"inches"</span><span class="op">)</span>,
                              ends <span class="op">=</span> <span class="st">"last"</span>,
                              type <span class="op">=</span> <span class="st">"closed"</span><span class="op">)</span>,
                default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_plotSegments.html">bb_plotSegments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">5.45</span>, y0 <span class="op">=</span> <span class="fl">2.5</span>, x1 <span class="op">=</span> <span class="fl">5.85</span>, y1 <span class="op">=</span> <span class="fl">2.5</span>, 
                linecolor <span class="op">=</span> <span class="st">"grey"</span>, fill <span class="op">=</span> <span class="st">"grey"</span>,
                arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>,
                              length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"inches"</span><span class="op">)</span>,
                              ends <span class="op">=</span> <span class="st">"last"</span>,
                              type <span class="op">=</span> <span class="st">"closed"</span><span class="op">)</span>,
                default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/shapes_04-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This makes our final <code>BentoBox</code> plot a combination of genomic data and other helpful figure elements:</p>
<p><img src="introduction_to_bentobox_files/figure-html/shapes_06-1.png" width="960" style="display: block; margin: auto;"></p>
<p>For more detailed usage of basic shape functions, see the function-specific reference examples with <code>?function()</code> (e.g. <code>?bb_plotCircle()</code>).</p>
</div>
</div>
<div id="plot-annotations" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-annotations" class="anchor"></a>Plot annotations</h1>
<p><code>BentoBox</code> is modular and separates plotting and annotating into two different categories of functions. To specify which plot to annotate within an annotation function, each annotation function has a <code>plot</code> parameter that accepts <code>BentoBox</code> plot objects. This will facilitate in inheriting genomic region and plot location information. In this section we will go through some of the major types of annotations used to create accurate and informative <code>BentoBox</code> plots.</p>
<div id="genome-labels" class="section level2">
<h2 class="hasAnchor">
<a href="#genome-labels" class="anchor"></a>Genome labels</h2>
<p>Genome labels are some of the most important annotations for giving context to the genomic region of data. <code><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel()</a></code>can add genome labels with various customizations.</p>
<p>Genome labels can be shown at three different basepair scales (Mb, Kb, and bp) depending on the size of the region and the desired accuracy of the start and end labels. In the genomic region <code>chr21:28000000-30300000</code> we can use a Mb scale:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">2.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>, scale <span class="op">=</span> <span class="st">"Mb"</span>,
                   x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">2.76</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_01-1.png" width="576" style="display: block; margin: auto;"></p>
<p>If we use a more specific genomic region like <code>chr21:28255554-29354665</code>, the Mb scale will be rounded and indicated with an approximation sign:</p>
<pre><code>#&gt; Warning: Start label is rounded.
#&gt; Warning: End label is rounded.</code></pre>
<p><img src="introduction_to_bentobox_files/figure-html/anno_02-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Thus, it makes more sense to use the bp scale for ultimate accuracy:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28255554</span>, chromend <span class="op">=</span> <span class="fl">29354665</span>,
                            x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">2.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>, scale <span class="op">=</span> <span class="st">"bp"</span>,
                   x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">2.76</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_03-1.png" width="576" style="display: block; margin: auto;"></p>
<p>If our genomic region is small enough, <code><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel()</a></code> can also be used to display the nucleotide sequence of that region. Similar to IGV, <code><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel()</a></code> will first represent nucleotides as colored boxes:</p>
<p><img src="introduction_to_bentobox_files/figure-html/anno_04-1.png" width="672" style="display: block; margin: auto;"></p>
<p>At even finer scales, <code><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel()</a></code> will then represent nucleotides with colored letters:</p>
<p><img src="introduction_to_bentobox_files/figure-html/anno_05-1.png" width="672" style="display: block; margin: auto;"></p>
<p>In the specific case of square Hi-C plots (<code>bb_hicSquare</code> objects), <code><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel()</a></code> can annotate the genome label along the y-axis:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">2.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>, scale <span class="op">=</span> <span class="st">"Mb"</span>,
                   axis <span class="op">=</span> <span class="st">"y"</span>,
                   x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.25</span>,
                   just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_06-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="plot-axes" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-axes" class="anchor"></a>Plot axes</h2>
<p>In addition to genomic axes, it is also common to annotate standard x and y-axes for measures of scale. This functionality is provided by the <code><a href="../reference/bb_annoXaxis.html">bb_annoXaxis()</a></code> and <code><a href="../reference/bb_annoYaxis.html">bb_annoYaxis()</a></code> functions. For example, a Manhattan plot requires a y-axis to indicate the range of p-values:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"TxDb.Hsapiens.UCSC.hg19.knownGene"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_gwasData"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">7.5</span>, height <span class="op">=</span> <span class="fl">2.75</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">manhattanPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotManhattan.html">bb_plotManhattan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_gwasData</span>, assembly <span class="op">=</span> <span class="st">"hg19"</span>,
                                  fill <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"#37a7db"</span><span class="op">)</span>,
                                  sigLine <span class="op">=</span> <span class="cn">TRUE</span>,
                                  col <span class="op">=</span> <span class="st">"grey"</span>, lty <span class="op">=</span> <span class="fl">2</span>, range <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">14</span><span class="op">)</span>,
                                  x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">6.5</span>, height <span class="op">=</span> <span class="fl">2</span>,
                                  just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                                  default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">manhattanPlot</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">2.25</span>, fontsize <span class="op">=</span> <span class="fl">8</span>,
                   just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotText.html">bb_plotText</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Chromosome"</span>, fontsize <span class="op">=</span> <span class="fl">8</span>,
            x <span class="op">=</span> <span class="fl">3.75</span>, y <span class="op">=</span> <span class="fl">2.45</span>, just <span class="op">=</span> <span class="st">"center"</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Annotate y-axis</span>
<span class="fu"><a href="../reference/bb_annoYaxis.html">bb_annoYaxis</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">manhattanPlot</span>, at <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>,
             axisLine <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="co">## Plot y-axis label</span>
<span class="fu"><a href="../reference/bb_plotText.html">bb_plotText</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"-log10(p-value)"</span>, x <span class="op">=</span> <span class="fl">0.15</span>, y <span class="op">=</span> <span class="fl">1.25</span>, rot <span class="op">=</span> <span class="fl">90</span>,
            fontsize <span class="op">=</span> <span class="fl">8</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, just <span class="op">=</span> <span class="st">"center"</span>,
            default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_07-1.png" width="912" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/bb_annoXaxis.html">bb_annoXaxis()</a></code> and <code><a href="../reference/bb_annoYaxis.html">bb_annoYaxis()</a></code> have similar usages and customizations.</p>
</div>
<div id="heatmap-legends" class="section level2">
<h2 class="hasAnchor">
<a href="#heatmap-legends" class="anchor"></a>Heatmap legends</h2>
<p>Heatmap-style plots with numbers translated to a palette of colors require a specific type of legend. This legend can be plotted with <code><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend()</a></code> in both vertical and horizontal orientations. Genomic plots that typically require this annotation are Hi-C plots made with <code><a href="../reference/bb_plotHicRectangle.html">bb_plotHicRectangle()</a></code>, <code><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare()</a></code>, or <code><a href="../reference/bb_plotHicTriangle.html">bb_plotHicTriangle()</a></code>.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_params.html">bb_params</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>, 
                    assembly <span class="op">=</span> <span class="st">"hg19"</span>,
                    x <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.75</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>, params <span class="op">=</span> <span class="va">params</span>,
                            zrange <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span>, resolution <span class="op">=</span> <span class="fl">10000</span>,
                            y <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">2.75</span><span class="op">)</span>

<span class="co">## Annotate Hi-C heatmap legend</span>
<span class="fu"><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>, fontsize <span class="op">=</span> <span class="fl">7</span>,
                     orientation <span class="op">=</span> <span class="st">"v"</span>,
                     x <span class="op">=</span> <span class="fl">0.125</span>, y <span class="op">=</span> <span class="fl">0.25</span>,
                     width <span class="op">=</span> <span class="fl">0.07</span>, height <span class="op">=</span> <span class="fl">0.5</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                     default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>, fontsize <span class="op">=</span> <span class="fl">7</span>,
                     orientation <span class="op">=</span> <span class="st">"h"</span>,
                     x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3.055</span>,
                     width <span class="op">=</span> <span class="fl">0.5</span>, height <span class="op">=</span> <span class="fl">0.07</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span>,
                     default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_08-1.png" width="504" style="display: block; margin: auto;"></p>
</div>
<div id="hi-c-pixels" class="section level2">
<h2 class="hasAnchor">
<a href="#hi-c-pixels" class="anchor"></a>Hi-C pixels</h2>
<p>It is also possible to annotate the pixels on a Hi-C plot with provided BEDPE data. Pixels can be annotated with boxes, circles, or squares.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedpeData"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.24</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>, resolution <span class="op">=</span> <span class="fl">10000</span>, zrange <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span>,
                             chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                             x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.75</span>, height <span class="op">=</span> <span class="fl">2.75</span>,
                             just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                             default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Annotate pixels</span>
<span class="va">pixels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_annoPixels.html">bb_annoPixels</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>, data <span class="op">=</span> <span class="va">bb_bedpeData</span>, type <span class="op">=</span> <span class="st">"box"</span>,
                        half <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_09-1.png" width="504" style="display: block; margin: auto;"></p>
<p>If we want to annotate one pixel of interest, we can subset our BEDPE data and <code><a href="../reference/bb_annoPixels.html">bb_annoPixels()</a></code> will only annotate the specified pixels:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedpeData"</span><span class="op">)</span>

<span class="co">## Subset BEDPE data</span>
<span class="va">bb_bedpeData</span> <span class="op">&lt;-</span> <span class="va">bb_bedpeData</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">bb_bedpeData</span><span class="op">$</span><span class="va">start1</span> <span class="op">==</span> <span class="fl">28220000</span> <span class="op">&amp;</span> <span class="va">bb_bedpeData</span><span class="op">$</span><span class="va">start2</span> <span class="op">==</span> <span class="fl">29070000</span><span class="op">)</span>,<span class="op">]</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.24</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>, resolution <span class="op">=</span> <span class="fl">10000</span>, zrange <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span>,
                             chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                             x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.75</span>, height <span class="op">=</span> <span class="fl">2.75</span>,
                             just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                             default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Annotate pixel</span>
<span class="va">pixels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_annoPixels.html">bb_annoPixels</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>, data <span class="op">=</span> <span class="va">bb_bedpeData</span>, type <span class="op">=</span> <span class="st">"arrow"</span>,
                        half <span class="op">=</span> <span class="st">"bottom"</span>, shift <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_10-1.png" width="504" style="display: block; margin: auto;"></p>
</div>
<div id="genomic-region-highlights-and-zooms" class="section level2">
<h2 class="hasAnchor">
<a href="#genomic-region-highlights-and-zooms" class="anchor"></a>Genomic region highlights and zooms</h2>
<p>The last category of annotations that is often used in plotting genomic data is highlighting and zooming. Many figures benefit from providing a broader context of data and then highlighting a smaller genomic region to show data at a finer scale. In this example, we will plot an ideogram and highlight and zoom in on a genomic region of interest to see the signal track data in that region.</p>
<p>First we can plot our ideogram:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"cytoBand.Hsapiens.UCSC.hg19"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">6.25</span>, height <span class="op">=</span> <span class="fl">2.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>, 
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">ideogramPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotIdeogram.html">bb_plotIdeogram</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, assembly <span class="op">=</span> <span class="st">"hg19"</span>,
                                orientation <span class="op">=</span> <span class="st">"h"</span>,
                                x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">5.75</span>, height <span class="op">=</span> <span class="fl">0.3</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_11-1.png" width="792" style="display: block; margin: auto;"></p>
<p>We can then use <code><a href="../reference/bb_annoHighlight.html">bb_annoHighlight()</a></code> to highlight our genomic region of interest (<code>chr21:28000000-30300000</code>) with a box of our desired <code>height</code>:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_params.html">bb_params</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_annoHighlight.html">bb_annoHighlight</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">ideogramPlot</span>, params <span class="op">=</span> <span class="va">region</span>,
                 fill <span class="op">=</span> <span class="st">"red"</span>, 
                 y <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">0.5</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_12-1.png" width="792" style="display: block; margin: auto;"></p>
<p>To make it clearer that we are zooming in on a genomic region, we can then use <code><a href="../reference/bb_annoZoomLines.html">bb_annoZoomLines()</a></code> to add zoom lines from the genomic region we highlighted:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_annoZoomLines.html">bb_annoZoomLines</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">ideogramPlot</span>, params <span class="op">=</span> <span class="va">region</span>,
                 y0 <span class="op">=</span> <span class="fl">0.75</span>, x1 <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">6</span><span class="op">)</span>, y1 <span class="op">=</span> <span class="fl">1.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_13-1.png" width="792" style="display: block; margin: auto;"></p>
<p>Finally, we can add our zoomed-in signal track data within the zoom lines:</p>
<p><img src="introduction_to_bentobox_files/figure-html/anno_14-1.png" width="792" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="bioconductor-integration" class="section level1">
<h1 class="hasAnchor">
<a href="#bioconductor-integration" class="anchor"></a>Bioconductor integration</h1>
<p><code>BentoBox</code> is designed to be compatible with typical Bioconductor classes of genomic data to easily integrate genomic data analysis and visualization. In addition to handling various genomic file types and <code>R</code> objects, many <code>BentoBox</code> functions can also handle <code>GRanges</code> objects as input data. Internally, <code>BentoBox</code> utilizes <code>TxDb</code>, <code>OrgDb</code>, and <code>BSgenome</code> objects for various genomic annotations, including gene and transcript structures and names, chromosome sizes, and nucleotide sequences. For standard genomic assemblies (i.e. hg19, hg38, mm10), <code>BentoBox</code> uses a set of default packages that can be displayed by calling <code><a href="../reference/bb_defaultPackages.html">bb_defaultPackages()</a></code>:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_defaultPackages.html">bb_defaultPackages</a></span><span class="op">(</span><span class="st">"hg19"</span><span class="op">)</span>
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ Genome        : chr "hg19"</span>
<span class="co">#&gt;  $ TxDb          : chr "TxDb.Hsapiens.UCSC.hg19.knownGene"</span>
<span class="co">#&gt;  $ OrgDb         : chr "org.Hs.eg.db"</span>
<span class="co">#&gt;  $ gene.id.column: chr "ENTREZID"</span>
<span class="co">#&gt;  $ display.column: chr "SYMBOL"</span>
<span class="co">#&gt;  $ BSgenome      : chr "BSgenome.Hsapiens.UCSC.hg19"</span>
<span class="co">#&gt;  - attr(*, "class")= chr "bb_assembly"</span>
<span class="fu"><a href="../reference/bb_defaultPackages.html">bb_defaultPackages</a></span><span class="op">(</span><span class="st">"hg38"</span><span class="op">)</span>
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ Genome        : chr "hg38"</span>
<span class="co">#&gt;  $ TxDb          : chr "TxDb.Hsapiens.UCSC.hg38.knownGene"</span>
<span class="co">#&gt;  $ OrgDb         : chr "org.Hs.eg.db"</span>
<span class="co">#&gt;  $ gene.id.column: chr "ENTREZID"</span>
<span class="co">#&gt;  $ display.column: chr "SYMBOL"</span>
<span class="co">#&gt;  $ BSgenome      : chr "BSgenome.Hsapiens.UCSC.hg38"</span>
<span class="co">#&gt;  - attr(*, "class")= chr "bb_assembly"</span>
<span class="fu"><a href="../reference/bb_defaultPackages.html">bb_defaultPackages</a></span><span class="op">(</span><span class="st">"mm10"</span><span class="op">)</span>
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ Genome        : chr "mm10"</span>
<span class="co">#&gt;  $ TxDb          : chr "TxDb.Mmusculus.UCSC.mm10.knownGene"</span>
<span class="co">#&gt;  $ OrgDb         : chr "org.Mm.eg.db"</span>
<span class="co">#&gt;  $ gene.id.column: chr "ENTREZID"</span>
<span class="co">#&gt;  $ display.column: chr "SYMBOL"</span>
<span class="co">#&gt;  $ BSgenome      : chr "BSgenome.Mmusculus.UCSC.mm10"</span>
<span class="co">#&gt;  - attr(*, "class")= chr "bb_assembly"</span></code></pre></div>
<p>To see which assemblies have defaults within <code>BentoBox</code>, call <code><a href="../reference/bb_genomes.html">bb_genomes()</a></code>:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_genomes.html">bb_genomes</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; bosTau8</span>
<span class="co">#&gt; bosTau9</span>
<span class="co">#&gt; canFam3</span>
<span class="co">#&gt; ce6</span>
<span class="co">#&gt; ce11</span>
<span class="co">#&gt; danRer10</span>
<span class="co">#&gt; danRer11</span>
<span class="co">#&gt; dm3</span>
<span class="co">#&gt; dm6</span>
<span class="co">#&gt; galGal4</span>
<span class="co">#&gt; galGal5</span>
<span class="co">#&gt; galGal6</span>
<span class="co">#&gt; hg18</span>
<span class="co">#&gt; hg19</span>
<span class="co">#&gt; hg38</span>
<span class="co">#&gt; mm9</span>
<span class="co">#&gt; mm10</span>
<span class="co">#&gt; rheMac3</span>
<span class="co">#&gt; rheMac8</span>
<span class="co">#&gt; rehMac10</span>
<span class="co">#&gt; panTro5</span>
<span class="co">#&gt; panTro6</span>
<span class="co">#&gt; rn4</span>
<span class="co">#&gt; rn5</span>
<span class="co">#&gt; rn6</span>
<span class="co">#&gt; sacCer2</span>
<span class="co">#&gt; sacCer3</span>
<span class="co">#&gt; susScr3</span>
<span class="co">#&gt; susScr11</span></code></pre></div>
<p><code>BentoBox</code> functions default to an “hg19” assembly. To create custom genomic assemblies and combinations of <code>TxDb</code>, <code>orgDb</code>, and <code>BSgenome</code> packages for use in <code>BentoBox</code> functions, we can use the <code><a href="../reference/bb_assembly.html">bb_assembly()</a></code> constructor. For example, we can create our own <code>TxDb</code> from the current human Ensembl release:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicFeatures">GenomicFeatures</a></span><span class="op">)</span>
<span class="va">TxDb.Hsapiens.Ensembl.GrCh38.103</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/makeTxDbFromEnsembl.html">makeTxDbFromEnsembl</a></span><span class="op">(</span>organism <span class="op">=</span> <span class="st">"Homo sapiens"</span><span class="op">)</span></code></pre></div>
<p>We can now create a new <code>bb_assembly</code> with this <code>TxDb</code> and combinations of other Bioconductor packages. The <code>Genome</code> parameter can be any string to name or describe this assembly. Since the <code>TxDb</code> is now from ENSEMBL, we will change the <code>gene.id</code> field to <code>"ENSEMBL"</code> to map gene IDs and symbols between our <code>TxDb</code> and <code>orgDb</code> objects. Most gene ID types can be found by calling <code><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">AnnotationDbi::keytypes()</a></code> on an <code>orgDb</code>.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ensembl38</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_assembly.html">bb_assembly</a></span><span class="op">(</span>Genome <span class="op">=</span> <span class="st">"Ensembl.GRCh38.103"</span>,
                         TxDb <span class="op">=</span> <span class="va">TxDb.Hsapiens.Ensembl.GrCh38.103</span>,
                         OrgDb <span class="op">=</span> <span class="st">"org.Hs.eg.db"</span>,
                         BSgenome <span class="op">=</span> <span class="st">"BSgenome.Hsapiens.NCBI.GRCh38"</span>,
                         gene.id <span class="op">=</span> <span class="st">"ENSEMBL"</span>, display.column <span class="op">=</span> <span class="st">"SYMBOL"</span><span class="op">)</span></code></pre></div>
<p>This <code>bb_assembly</code> object can now be easily passed into <code>BentoBox</code> functions through the <code>assembly</code> parameter.</p>
</div>
<div id="plot-aesthetics" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-aesthetics" class="anchor"></a>Plot aesthetics</h1>
<p><code>BentoBox</code> plots are extremely customizable in appearance. In this section we will outline some of the major aesthetic customizations, including general features and specific plot type customizations.</p>
<div id="gpar-and-common-plot-customizations" class="section level2">
<h2 class="hasAnchor">
<a href="#gpar-and-common-plot-customizations" class="anchor"></a><code>gpar</code> and common plot customizations</h2>
<p>The most common types of customizations are inherited from <code>grid</code> <code>gpar</code> options. If a function accepts <code>...</code>, this usually refers to <code>gpar</code> options that are not explicity listed as parameters in the function documentation. General valid parameters include:</p>
<table class="table">
<colgroup>
<col width="59%">
<col width="40%">
</colgroup>
<tbody>
<tr class="odd">
<td align="right"><strong>alpha</strong></td>
<td align="left">Alpha channel for transparency (number between 0 and 1).</td>
</tr>
<tr class="even">
<td align="right"><strong>fill</strong></td>
<td align="left">Fill color.</td>
</tr>
<tr class="odd">
<td align="right"><strong>linecolor</strong></td>
<td align="left">Line color.</td>
</tr>
<tr class="even">
<td align="right"><strong>lty</strong></td>
<td align="left">Line type. (0=blank, 1=solid, 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash).</td>
</tr>
<tr class="odd">
<td align="right"><strong>lwd</strong></td>
<td align="left">Line width.</td>
</tr>
<tr class="even">
<td align="right"><strong>lineend</strong></td>
<td align="left">Line end style (round, butt, square).</td>
</tr>
<tr class="odd">
<td align="right"><strong>linejoin</strong></td>
<td align="left">Line join style (round, mitre, bevel).</td>
</tr>
<tr class="even">
<td align="right"><strong>linemitre</strong></td>
<td align="left">Line mitre limit (number greater than 1).</td>
</tr>
<tr class="odd">
<td align="right"><strong>fontsize</strong></td>
<td align="left">The size of text, in points.</td>
</tr>
<tr class="even">
<td align="right"><strong>fontcolor</strong></td>
<td align="left">Text color.</td>
</tr>
<tr class="odd">
<td align="right"><strong>fontface</strong></td>
<td align="left">The font face (plain, bold, italic, bold.italic, oblique).</td>
</tr>
<tr class="even">
<td align="right"><strong>fontfamily</strong></td>
<td align="left">The font family.</td>
</tr>
<tr class="odd">
<td align="right"><strong>cex</strong></td>
<td align="left">Scaling multiplier applied to symbols.</td>
</tr>
<tr class="even">
<td align="right"><strong>pch</strong></td>
<td align="left">Plotting character, or symbol (integer codes range from 0 to 25).</td>
</tr>
</tbody>
</table>
<p>Additional fonts for the <code>fontfamily</code> argument can be imported with the package <code>extrafont</code>. This makes it possible to incorporate more standard fonts like Times New Roman, Arial, etc. into <code>BentoBox</code> figures.</p>
</div>
<div id="backgrounds-and-baselines" class="section level2">
<h2 class="hasAnchor">
<a href="#backgrounds-and-baselines" class="anchor"></a>Backgrounds and baselines</h2>
<p>By default, <code>BentoBox</code> plots have transparent backgrounds when placed on a <code>bb_page</code>. In many functions, this background color can be changed with the parameter <code>bg</code>.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr8"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">2000000</span>,
             bg <span class="op">=</span> <span class="st">"#f6f6f6"</span>,
             x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, 
             default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_01-1.png" width="480" style="display: block; margin: auto;"> This makes it easy to clearly see the precise dimensional boundaries of <code>BentoBox</code> plots.</p>
<p>Some plots also benefit from baselines to quickly show where y = 0. This can aid in data interpretation and guide plot annotation placement. Baselines can be plotted in selective plots with <code>baseline = TRUE</code>.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_plotBed.html">bb_plotBed</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_bedData</span>, 
           chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">29073000</span>, chromend <span class="op">=</span> <span class="fl">29074000</span>,
           fill <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"#7ecdbb"</span>, <span class="st">"#37a7db"</span><span class="op">)</span>,
           baseline <span class="op">=</span> <span class="cn">TRUE</span>, baseline.color <span class="op">=</span> <span class="st">"black"</span>,
           x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">6.5</span>, height <span class="op">=</span> <span class="fl">4.25</span>,
           just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_02-1.png" width="912" style="display: block; margin: auto;"></p>
</div>
<div id="colorby" class="section level2">
<h2 class="hasAnchor">
<a href="#colorby" class="anchor"></a><code>colorby</code>
</h2>
<p>The <code>colorby</code> constructor allows us to color the data elements in <code>BentoBox</code> plots by various data features. These features can be a numerical range, like some kind of score value, or categorical values, like positive or negative strand. The <code>colorby</code> object is constructed by specifying the name of the data column to color by and an optional range for numerical values.</p>
<p>For example, if we revist the BED plot above, <code>bb_bedData</code> has an additional <code>strand</code> column for each BED element:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bb_bedData</span><span class="op">)</span>
<span class="co">#&gt;          chrom    start      end strand</span>
<span class="co">#&gt; 15554862 chr21 28000052 28000088      -</span>
<span class="co">#&gt; 15554863 chr21 28000092 28000128      -</span>
<span class="co">#&gt; 15554864 chr21 28000162 28000198      -</span>
<span class="co">#&gt; 15554865 chr21 28000251 28000287      +</span>
<span class="co">#&gt; 15554866 chr21 28000335 28000371      -</span>
<span class="co">#&gt; 15554867 chr21 28000500 28000536      +</span></code></pre></div>
<p>Thus, we can use the <code>colorby</code> constructor to color BED elements by positive or negative strand. The <code>strand</code> column will be converted to a factor with a <code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code> level and <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> level. These values will be assigned to the <code>fill</code> colors in the order of these factors.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_plotBed.html">bb_plotBed</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_bedData</span>, 
           chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">29073000</span>, chromend <span class="op">=</span> <span class="fl">29074000</span>,
           fill <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"#7ecdbb"</span>, <span class="st">"#37a7db"</span><span class="op">)</span>,
           colorby <span class="op">=</span> <span class="fu"><a href="../reference/colorby.html">colorby</a></span><span class="op">(</span><span class="st">"strand"</span><span class="op">)</span>,
           x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">6.5</span>, height <span class="op">=</span> <span class="fl">4.25</span>,
           just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_03-1.png" width="912" style="display: block; margin: auto;"></p>
<p>To further control the order of color assignment, we can set our categorical <code>colorby</code> column as a factor with our own order of levels before plotting:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedData"</span><span class="op">)</span>
<span class="va">bb_bedData</span><span class="op">$</span><span class="va">strand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">bb_bedData</span><span class="op">$</span><span class="va">strand</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">bb_bedData</span><span class="op">$</span><span class="va">strand</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="st">"-"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bb_bedData</span><span class="op">$</span><span class="va">strand</span><span class="op">)</span>
<span class="co">#&gt; [1] + + + - + -</span>
<span class="co">#&gt; Levels: + -</span></code></pre></div>
<p>Now we’ve set the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> level as our first level, so the first value in <code>fill</code> will color the plus-stranded elements and the second <code>fill</code> value will color the minus-stranded elements:</p>
<p><img src="introduction_to_bentobox_files/figure-html/aes_04-1.png" width="912" style="display: block; margin: auto;"></p>
<p>In this example, we will color BEDPE arches by a range of numerical values we will add as a <code>length</code> column:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedpeData"</span><span class="op">)</span>
<span class="va">bb_bedpeData</span><span class="op">$</span><span class="va">length</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bb_bedpeData</span><span class="op">$</span><span class="va">start2</span> <span class="op">-</span> <span class="va">bb_bedpeData</span><span class="op">$</span><span class="va">start1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bb_bedpeData</span><span class="op">$</span><span class="va">length</span><span class="op">)</span>
<span class="co">#&gt; [1]   65 1960 2100  850 1200 1485</span></code></pre></div>
<p>Now we can set <code>fill</code> as a palette to color the BEDPE <code>length</code> column by:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bedpePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotBedpeArches.html">bb_plotBedpeArches</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_bedpeData</span>, 
                                chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">27900000</span>, chromend <span class="op">=</span> <span class="fl">30700000</span>,
                                fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"dodgerblue2"</span>, <span class="st">"firebrick2"</span><span class="op">)</span><span class="op">)</span>,
                                linecolor <span class="op">=</span> <span class="st">"fill"</span>,
                                colorby <span class="op">=</span> <span class="fu"><a href="../reference/colorby.html">colorby</a></span><span class="op">(</span><span class="st">"length"</span><span class="op">)</span>,
                                archHeight <span class="op">=</span> <span class="va">bb_bedpeData</span><span class="op">$</span><span class="va">length</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">bb_bedpeData</span><span class="op">$</span><span class="va">length</span><span class="op">)</span>, 
                                alpha <span class="op">=</span> <span class="fl">1</span>,
                                x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">1.5</span>,
                                just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,
                                default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_05-1.png" width="912" style="display: block; margin: auto;"></p>
<p>And now since we have numbers mapped to colors, we can use <code><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend()</a></code> with our <code>bb_arches</code> object to add a legend for the <code>colorby</code> we performed:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">bedpePlot</span>, fontcolor <span class="op">=</span> <span class="st">"black"</span>,
                     x <span class="op">=</span> <span class="fl">7.0</span>, y <span class="op">=</span> <span class="fl">0.25</span>,
                     width <span class="op">=</span> <span class="fl">0.10</span>, height <span class="op">=</span> <span class="fl">1</span>, fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_06-1.png" width="912" style="display: block; margin: auto;"></p>
</div>
<div id="gene-and-transcript-plot-aesthetics" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-and-transcript-plot-aesthetics" class="anchor"></a>Gene and transcript plot aesthetics</h2>
<p><code>BentoBox</code> provides many useful features specific for enhancing gene and transcript visualizations:</p>
<div id="labels" class="section level3">
<h3 class="hasAnchor">
<a href="#labels" class="anchor"></a>Labels</h3>
<p>Since <code>BentoBox</code> utilizes <code>TxDb</code> objects, <code>orgDb</code> objects, and internal citation information, <code>BentoBox</code> has access to numerous gene and transcript identifiers and can customize annotation labels in a variety of ways.</p>
<p>By default, <code>BentoBox</code> will rank gene labels according to citation number to prevent label overcrowding. However, we can provide our own list of prioritized genes to label in a plot. For example, if we plot the hg19 genes in the region <code>chr2:1000000-20000000</code>, our plot will show these labels:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">1.25</span>, showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">genePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr2"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">20000000</span>,
                         x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">4.75</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_07-1.png" width="480" style="display: block; margin: auto;"> Looking in the <code>bb_genes</code> object, we can see that there were numerous genes that were not labeled.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genePlot</span><span class="op">$</span><span class="va">genes</span>
<span class="co">#&gt;  [1] "MIR3125"      "RNASEH1-AS1"  "LOC100506274" "MIR4757"      "LINC00570"   </span>
<span class="co">#&gt;  [6] "C2orf50"      "SLC66A3"      "SILC1"        "LRATD1"       "DDX1"        </span>
<span class="co">#&gt; [11] "LPIN1"        "ATP6V1C2"     "IAH1"         "TRIB2"        "GRHL1"       </span>
<span class="co">#&gt; [16] "HPCAL1"       "ID2"          "MSGN1"        "GEN1"         NA            </span>
<span class="co">#&gt; [21] "KCNF1"        "KCNS3"        "LOC400940"    "MYCN"         "TRAPPC12"    </span>
<span class="co">#&gt; [26] "CPSF3"        "SNTG2"        "ALLC"         "RPS7"         "RRM2"        </span>
<span class="co">#&gt; [31] "SOX11"        "TPO"          "MYT1L-AS1"    "VSNL1"        "COLEC11"     </span>
<span class="co">#&gt; [36] "KLF11"        "ASAP2"        "TAF1B"        "RSAD2"        "GREB1"       </span>
<span class="co">#&gt; [41] "RNF144A"      "SNORA80B"     "MIR4261"      "MIR4262"      "LINC01304"   </span>
<span class="co">#&gt; [46] "LOC100506474" "NT5C1B-RDH14" "MIR4429"      "PDIA6"        "MYCNOS"      </span>
<span class="co">#&gt; [51] "YWHAQ"        "CMPK2"        "MBOAT2"       "OSR1"         "E2F6"        </span>
<span class="co">#&gt; [56] "CYS1"         "MYT1L"        "NTSR2"        "RNASEH1"      "FLJ33534"    </span>
<span class="co">#&gt; [61] "LINC00298"    "LINC00299"    "GRASLND"      "LINC00487"    "ODC1"        </span>
<span class="co">#&gt; [66] "NBAS"         "ADI1"         "KIDINS220"    "RDH14"        "ADAM17"      </span>
<span class="co">#&gt; [71] "EIPR1"        "LINC01249"    "RAD51AP2"     "PXDN"         "SMC6"        </span>
<span class="co">#&gt; [76] "NOL10"        "CYRIA"        "ITGB1BP1"     "NT5C1B"       "ROCK2"</span></code></pre></div>
<p>If we were particularly interested in MIR3125, we could include this in the <code>geneOrder</code> parameter to prioritize its labeling:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">1.25</span>, showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">genePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr2"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">20000000</span>,
                         geneOrder <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"MIR3125"</span><span class="op">)</span>,
                         x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">4.75</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_08-1.png" width="480" style="display: block; margin: auto;"></p>
<p>If we wanted to change the type of label in our plot, we can change the <code>display.column</code> parameter in a <code><a href="../reference/bb_assembly.html">bb_assembly()</a></code> object. The default <code>display.column = "SYMBOL"</code>, but we could change this value to other available <code>keytypes</code> in the <code>orgDb</code> we are using. For example, if we wanted to display the associated Ensembl IDs, we would set <code>display.column = "ENSEMBL"</code>:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_hg19</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_assembly.html">bb_assembly</a></span><span class="op">(</span>Genome <span class="op">=</span> <span class="st">"id_hg19"</span>,
                        TxDb <span class="op">=</span> <span class="st">"TxDb.Hsapiens.UCSC.hg19.knownGene"</span>,
                        OrgDb <span class="op">=</span> <span class="st">"org.Hs.eg.db"</span>,
                        gene.id.column <span class="op">=</span> <span class="st">"ENTREZID"</span>,
                        display.column <span class="op">=</span> <span class="st">"ENSEMBL"</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">1.25</span>, showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">genePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr2"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">20000000</span>,
                         assembly <span class="op">=</span> <span class="va">new_hg19</span>,
                         x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">4.75</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_09-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Label IDs used in transcript plots can be customized through <code><a href="../reference/bb_assembly.html">bb_assembly()</a></code> objects, and transcript label formatting can be changed through the <code>labels</code> parameter. For example, if we wish to display both transcript names and their associated gene names, we can set <code>labels = "both"</code>:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">5</span>, showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">transcriptPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotTranscripts.html">bb_plotTranscripts</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr2"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">20000000</span>,
                                     labels <span class="op">=</span> <span class="st">"both"</span>,
                                     x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">5.5</span>, height <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="highlighting-genes-by-color" class="section level3">
<h3 class="hasAnchor">
<a href="#highlighting-genes-by-color" class="anchor"></a>Highlighting genes by color</h3>
<p>In addition to changing <code>fill</code> and <code>fontcolor</code> to change the colors of all genes in a plot, specific gene structures and their labels can be highlighted in a different color with <code>geneHighlights</code>. If we revisit the <code>bb_genes</code> plot above, we can highlight RRM2 by creating a <code>data.frame</code> with “RRM2” in the first column and its highlight color in the second column:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">geneHighlights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"geneName"</span> <span class="op">=</span> <span class="st">"RRM2"</span>, <span class="st">"color"</span> <span class="op">=</span> <span class="st">"steel blue"</span><span class="op">)</span></code></pre></div>
<p>We can then pass this into our <code><a href="../reference/bb_plotGenes.html">bb_plotGenes()</a></code> call:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">1.25</span>, showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">genePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr2"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">20000000</span>,
                         geneHighlights <span class="op">=</span> <span class="va">geneHighlights</span>, geneBackground <span class="op">=</span> <span class="st">"grey"</span>,
                         x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">4.75</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_11-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Since <code>geneHighlights</code> is a <code>data.frame</code>, we can highlight multiple genes in different colors at once. For example, let’s now highlight RRM2 in “steel blue” and PXDN in “red”:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">geneHighlights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"geneName"</span> <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"RRM2"</span>, <span class="st">"PXDN"</span><span class="op">)</span>, <span class="st">"color"</span> <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"steel blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">1.25</span>, showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">genePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr2"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">20000000</span>,
                         geneHighlights <span class="op">=</span> <span class="va">geneHighlights</span>, geneBackground <span class="op">=</span> <span class="st">"grey"</span>,
                         x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">4.75</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_12-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="customizing-transcripts-by-strand" class="section level3">
<h3 class="hasAnchor">
<a href="#customizing-transcripts-by-strand" class="anchor"></a>Customizing transcripts by strand</h3>
<p>To distinguish which strand a transcript belongs to, <code><a href="../reference/bb_plotTranscripts.html">bb_plotTranscripts()</a></code> colors transcripts by strand with the parameter <code>colorbyStrand</code>. The first value in <code>fill</code> colors positive strand transcripts and the second <code>fill</code> value colors negative strand transcripts. To further organize transcripts by strand, we can use <code>strandSplit</code> to separate transcript elements into groups of positive and negative strands:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">5</span>, showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">transcriptPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotTranscripts.html">bb_plotTranscripts</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr2"</span>, chromstart <span class="op">=</span> <span class="fl">1000000</span>, chromend <span class="op">=</span> <span class="fl">20000000</span>,
                                     strandSplit <span class="op">=</span> <span class="cn">TRUE</span>,
                                     x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">5.5</span>, height <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_13-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Now all our positive strand transcripts are grouped together above the group of negative strand transcripts.</p>
</div>
</div>
<div id="hi-c-plot-customizations" class="section level2">
<h2 class="hasAnchor">
<a href="#hi-c-plot-customizations" class="anchor"></a>Hi-C plot customizations</h2>
<p><code>BentoBox</code> includes many types of customizations for Hi-C plots. <code>BentoBox</code> provides 3 different Hi-C plotting functions based on the desired plot shape:</p>
<ul>
<li><p><code><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare()</a></code>: Plots a square, symmetrical Hi-C plot with genomic coordinates along both the x- and y-axes.</p></li>
<li><p><code><a href="../reference/bb_plotHicTriangle.html">bb_plotHicTriangle()</a></code>: Plots a triangular Hi-C plot where the genome region falls along the base of the triangle.</p></li>
<li><p><code><a href="../reference/bb_plotHicRectangle.html">bb_plotHicRectangle()</a></code>: Plots a triangular Hi-C plot with additional data filling the surrounding regions to form a rectangle.</p></li>
</ul>
<p><img src="introduction_to_bentobox_files/figure-html/aes_14-1.png" width="936" style="display: block; margin: auto;"></p>
<p>All Hi-C plot types can use different color palettes, and colors can be linearly or log-scaled with the <code>colorTrans</code> parameter.</p>
<p><code>bb_hicSquare</code> plots can be further customized to include two datasets in one plot. Instead of plotting both symmetrical halves of the plot, we can set one dataset as <code>half = "top"</code> and the other dataset as <code>half = "bottom"</code>:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_gmHicData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>

<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
              showGuides <span class="op">=</span> <span class="cn">FALSE</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_params.html">bb_params</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>, 
                    assembly <span class="op">=</span> <span class="st">"hg19"</span>, resolution <span class="op">=</span> <span class="fl">10000</span>,
                    x <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.75</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>


<span class="va">hicPlot_top</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_gmHicData</span>, params <span class="op">=</span> <span class="va">params</span>,
                                zrange <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span>,
                                half <span class="op">=</span> <span class="st">"top"</span>,
                                y <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">2.75</span><span class="op">)</span>
<span class="va">hicPlot_bottom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>, params <span class="op">=</span> <span class="va">params</span>,
                                zrange <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span>,
                                half <span class="op">=</span> <span class="st">"bottom"</span>,
                                y <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">2.75</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/aes_15-1.png" width="504" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/nekramer">Nicole Kramer</a>, <a href="https://github.com/EricSDavis">Eric S. Davis</a>, <a href="https://github.com/cwenger">Craig Wenger</a>, <a href="https://github.com/dphansti">Douglas H. Phanstiel</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
